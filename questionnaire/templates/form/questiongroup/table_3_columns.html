{% comment %}
  Two columns (4 / 8), one question in each. This is repeated if more than 2 questions.

  Adds buttons to add or remove additional questiongroups

  config: The configuration of the questiongroup

  formset: The (repeating) forms as formset

{% endcomment %}

{% load i18n %}
{% load floppyforms %}
{% load list_to_columns %}

<div{% if config.questiongroup_condition %} id="{{ config.questiongroup_condition }}"{% endif %} class="questiongroup{% if config.numbered %} questiongroup-numbered-{{ config.numbered }}{% endif %}{% if config.numbered == 'prefix' %} sortable{% endif %}">
{{ formset.management_form }}
  <table>
    {% for qg_form in formset.forms %}
      <thead>
        {% for field in qg_form.visible_fields %}

          {% if forloop.counter == 1 %}
            <tr>
          {% endif %}

          {% if forloop.counter < 4 %}
            <th>{{ field.label }}</th>
          {% endif %}

          {% if forloop.counter == 3 %}
            </tr>
          {% endif %}

        {% endfor %}
      </thead>
      <tbody>
        {% for field in qg_form.visible_fields %}
          {% if forloop.first %}
            <tr>
          {% elif forloop.counter0|divisibleby:3 and not forloop.last %}
            </tr><tr>
          {% endif %}

          <td>
            {% formrow field using "form/question/no_label.html" %}
          </td>

          {% if forloop.last %}
            </tr>
          {% endif %}
        {% endfor %}
      </tbody>
    {% endfor %}
  </table>
</div>
